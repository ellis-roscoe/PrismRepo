<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üåà Prismatic Repo</title>

  <!-- Inter (Figma‚Äôs UI font) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0f1115;
      --card: #141821;
      --muted: #9aa4b2;
      --text: #e7e9ee;
      --pill: #1b2130;
      --ring: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --accent: linear-gradient(135deg,#ff8ba7,#f9d1d1,#f6c,#a3c4f3,#7bdff2,#b9fbc0);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(255,255,255,.06), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(255,255,255,.04), transparent 60%),
        var(--bg);
    }
    header{
      padding: 48px 24px 16px;
      text-align:center;
    }
    .brand{
      display:inline-flex; align-items:center; gap:14px;
      font-weight:800; font-size: clamp(24px, 5vw, 40px);
      letter-spacing: .3px;
    }
    .prism{
      width:40px; height:40px; border-radius:12px; position:relative; overflow:hidden;
      background: var(--accent);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.15), var(--ring);
    }
    .prism::after{
      content:""; position:absolute; inset:6px; border-radius:10px;
      background: #fff; clip-path: polygon(50% 10%, 90% 85%, 10% 85%);
    }
    .sub{
      margin-top:10px; color:var(--muted);
      font-size:14px;
    }

    .toolbar{
      max-width:1100px; margin:24px auto 0; padding:0 20px;
      display:grid; grid-template-columns: 1fr auto; gap:12px; align-items:center;
    }
    .search{
      display:flex; align-items:center; gap:10px;
      background: var(--card); border-radius:12px; padding:10px 14px;
      box-shadow: var(--ring); border:1px solid rgba(255,255,255,.06);
    }
    .search input{
      flex:1; background:transparent; border:0; outline:0; color:var(--text); font-size:15px;
    }
    .pill{
      background: var(--pill); border:1px solid rgba(255,255,255,.06);
      padding:10px 12px; border-radius:12px; color:var(--muted); font-size:14px;
    }

    .grid{
      max-width:1100px; margin:16px auto 60px; padding:0 20px;
      display:grid; gap:16px;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }
    .card{
      background: var(--card); border-radius: var(--radius);
      padding:16px; box-shadow: var(--ring);
      border:1px solid rgba(255,255,255,.06);
      display:flex; flex-direction:column; gap:12px;
      transition: transform .12s ease, border-color .12s ease;
    }
    .card:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.14); }
    .row{ display:flex; gap:12px; align-items:center; }
    .icon{
      width:60px; height:60px; border-radius:14px; flex:0 0 auto;
      background:#0b0e14; object-fit:cover;
      border:1px solid rgba(255,255,255,.08);
    }
    .title{ font-weight:700; font-size:16px; line-height:1.2; }
    .meta{ color:var(--muted); font-size:12px; }
    .desc{ color:#cdd3de; font-size:14px; line-height:1.4; min-height: 3.2em; }
    .actions{ display:flex; gap:10px; margin-top:auto; }
    .btn{
      appearance:none; border:0; cursor:pointer; text-decoration:none;
      padding:10px 12px; border-radius:12px; font-weight:600; font-size:14px;
      color:#0c0f14; background:var(--accent);
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
    }
    .ghost{
      background:transparent; color:var(--muted);
      border:1px solid rgba(255,255,255,.12);
    }

    footer{
      text-align:center; color:var(--muted); font-size:12px; padding:28px 16px 42px;
    }
  </style>
</head>
<body>
  <header>
    <div class="brand"><span class="prism"></span> Prismatic Repo</div>
    <div class="sub">Clean, mod-forward iOS repo with a tasteful vibe.</div>
  </header>

  <section class="toolbar">
    <div class="search">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M21 21l-4.2-4.2M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z"
              stroke="currentColor" stroke-width="1.6" opacity=".6" />
      </svg>
      <input id="q" placeholder="Search apps, tweaks, devs‚Ä¶" autocomplete="off">
    </div>
    <div class="pill" id="count">Loading‚Ä¶</div>
  </section>

  <main class="grid" id="grid" aria-live="polite"></main>

  <footer>For educational use only. Please support original developers you love. ‚ù§Ô∏è</footer>

  <script>
    // ‚úÖ Point this at your RAW repo.json
    const REPO_URL = "https://raw.githubusercontent.com/ellis-roscoe/PrismaticRepo/refs/heads/main/repo.json";

    const grid = document.getElementById('grid');
    const count = document.getElementById('count');
    const q = document.getElementById('q');
    let apps = [];

    const card = (app) => `
      <article class="card">
        <div class="row">
          <img class="icon" src="${app.iconURL}" alt="${app.name} icon"
               onerror="this.src='https://via.placeholder.com/120?text=Icon'">
          <div>
            <div class="title">${app.name}</div>
            <div class="meta">${app.developerName || ''} ¬∑ <span>${app.version || ''}</span></div>
          </div>
        </div>
        <div class="desc">${app.localizedDescription || ''}</div>
        <div class="actions">
          <a class="btn" href="${app.downloadURL}">Download IPA</a>
          <a class="btn ghost" href="${app.iconURL}" target="_blank" rel="noopener">Icon</a>
        </div>
      </article>
    `;

    function render(list){
      grid.innerHTML = list.map(card).join('');
      count.textContent = `${list.length} ${list.length===1?'app':'apps'}`;
    }

    async function boot(){
      try{
        const res = await fetch(REPO_URL, {cache: "no-store"});
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        apps = (data.apps || []).map(a => ({
          ...a,
          name: a.name?.trim() || 'Untitled',
          developerName: a.developerName || '',
          version: a.version || '',
          localizedDescription: a.localizedDescription || ''
        }));
        // Sort by name (A‚ÜíZ)
        apps.sort((a,b)=> a.name.localeCompare(b.name));
        render(apps);
      } catch (e){
        grid.innerHTML = `<div class="card"><div class="title">Couldn‚Äôt load repo.json</div>
          <div class="desc">Make sure you‚Äôre using the RAW GitHub URL and it‚Äôs publicly accessible.</div></div>`;
        count.textContent = "‚Äî";
        console.error(e);
      }
    }

    q.addEventListener('input', () => {
      const s = q.value.toLowerCase();
      const filtered = apps.filter(a =>
        a.name.toLowerCase().includes(s) ||
        (a.developerName||'').toLowerCase().includes(s) ||
        (a.localizedDescription||'').toLowerCase().includes(s)
      );
      render(filtered);
    });

    boot();
  </script>
</body>
</html>
